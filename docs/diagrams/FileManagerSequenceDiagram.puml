@startuml
'https://plantuml.com/sequence-diagram
!include Styles.puml

box filemanager COLOR_STORAGE_SEGMENT
participant ":Storage" as Storage COLOR_STORAGE
participant ":InstrumentDecoder" as InstrumentDecoder COLOR_STORAGE
participant ":CryptoDecoder" as CryptoDecoder COLOR_STORAGE
end box

box model COLOR_MODEL_SEGMENT
participant ":InstrumentManager" as InstrumentManager COLOR_MODEL
participant ":Crypto" as Crypto COLOR_MODEL
end box

box ui COLOR_LIGHT_BLUE
participant ":TextUi" as TextUi COLOR_UI
end box

[-> Storage: loadFileData(instrumentManager)
activate Storage
alt file does not exist or is not a regular file

Storage-> TextUi: displayCreateFile()
activate TextUi

TextUi--> Storage
deactivate TextUi

else file exists and is regular
Storage-> TextUi: displayLoadingFile()
activate TextUi

TextUi-> Storage:
deactivate TextUi

Storage-> InstrumentDecoder: readFile(instrumentManager, fileData)
activate InstrumentDecoder

loop each line in the file
InstrumentDecoder-> InstrumentDecoder: addSavedInstrumentToList(instrumentManager, textSegment)
activate InstrumentDecoder

note right
The parameter textSegment is
the array of Crypto parameters:
{"Crypto", "32.0", "positive", "19 Dec", ""}
end note

opt Instrument type is Crypto/Etf/Stock/Forex
InstrumentDecoder-> CryptoDecoder: addCryptoToList(textSegment, instrumentManager)
activate CryptoDecoder

note bottom
Displaying only the outcome of adding
a pre-existing Crypto to list. This if
statement is supposed to be a switch statement
amongst the 4 different instruments
end note

create Crypto
CryptoDecoder-> Crypto: new Crypto("Crypto", 32.0, "positive", "19 Dec", "")
activate Crypto


Crypto--> CryptoDecoder
deactivate Crypto

CryptoDecoder-> CryptoDecoder: setDoneStatus(true, crypto)
activate CryptoDecoder
CryptoDecoder--> CryptoDecoder
deactivate CryptoDecoder

CryptoDecoder-> InstrumentManager: addInstrument(crypto)
activate InstrumentManager

InstrumentManager--> CryptoDecoder
deactivate InstrumentManager

CryptoDecoder--> InstrumentDecoder
deactivate CryptoDecoder

InstrumentDecoder--> InstrumentDecoder
deactivate InstrumentDecoder
InstrumentDecoder--> Storage
deactivate InstrumentDecoder

[<-- Storage
deactivate Storage

end

end

end

@enduml